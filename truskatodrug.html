<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Transformer</title>
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: 'Courier New', Courier, monospace;
        }

        h1 {
            text-align: center;
            color: #ff4444;
            font-size: 2.5em;
            margin-top: 20px;
        }

        .container {
            width: 90%;
            margin: 0 auto;
        }

        .input-area {
            margin: 30px 0;
            text-align: center;
        }

        textarea {
            width: 80%;
            height: 100px;
            background-color: #1e1e1e;
            color: #e0e0e0;
            border: 1px solid #333333;
            padding: 10px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 1.1em;
        }

        button {
            background-color: #ff4444;
            color: #fff;
            border: none;
            padding: 10px 20px;
            font-size: 1.2em;
            cursor: pointer;
            margin-top: 10px;
        }

        button:hover {
            background-color: #e63333;
        }

        .output-area {
            margin-top: 30px;
            text-align: center;
        }

        .output-box {
            width: 80%;
            margin: 20px auto;
            background-color: #1e1e1e;
            padding: 15px;
            border: 1px solid #333333;
            color: #e0e0e0;
        }

        .input-label {
            color: #ff4444;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <h1>Text Transformer</h1>
    <div class="container">
        <div class="input-area">
            <label class="input-label" for="input-text">Enter text to transform:</label><br>
            <textarea id="input-text" placeholder="Type your words here..."></textarea><br>
            <button onclick="transformText()">Transform</button>
        </div>

        <div class="input-area">
            <label class="input-label" for="file-input">Or upload a text file:</label><br>
            <input type="file" id="file-input" accept=".txt" /><br>
            <button onclick="uploadAndTransform()">Upload and Transform</button>
        </div>

        <div class="output-area">
            <div class="output-box" id="output-text">
                Your transformed text will appear here...
            </div>
        </div>
    </div>

    <script>
        // Replace long vowels function
        function replaceLongVowels(text) {
            const replacements = {
                'iģh': 'ī', 'ïgh': 'î', 'ugh': 'ū', 'üģh': 'û', 'eģh': 'ē', 'ëgh': 'ê',
                'ogh': 'ō', 'öģh': 'ô', 'agh': 'ā', 'aģh': 'ā'
            };
            for (let [key, value] of Object.entries(replacements)) {
                text = text.split(key).join(value);
            }
            return text;
        }

        // Main transformation logic
        function transformText() {
            let input = document.getElementById("input-text").value;

            // Apply text transformations
            let transformedText = replaceLongVowels(input);
            transformedText = replaceText(transformedText); // Call replace_text equivalent function

            // Display output
            document.getElementById("output-text").textContent = transformedText;
        }

        // Replace text function, simplified
        function replaceText(text) {
            const consonantReplacements = [
                [/ghr#/g, 'ghr#'], [/xr#/g, 'xr#'], [/sh#/g, 'sh#'], [/s#/g, 's#'], [/f#/g, 'f#'],
                [/schr/g, 'kr'], [/skr/g, 'qr'], [/shr/g, 'chr'], [/sçļ/g, 'qr'], [/çhļ/g, 'kr'],
                [/chr/g, 'j'], [/sch/g, 'k'], [/scl/g, 'sl'], [/str/g, 'kr'], [/spr/g, 'tr'],
                [/fr/g, 'pr'], [/pr/g, 'br'], [/br/g, 'v'], [/sp/g, 't'], [/sl/g, 'cl'],
                [/cl/g, 'dr'], [/dr/g, 'z'], [/tr/g, 'r'], [/st/g, 'k'], [/sc/g, 's'],
                [/sh/g, 'ch'], [/ch/g, 'j'], [/çh/g, 'k'], [/ģh/g, 'x'], [/çļ/g, 'gr'],
                [/ģļ/g, 'ghr'], [/sç/g, 'q'], [/gh/g, 'x'], [/xr/g, 'kr'], [/kr/g, 'gr'],
                [/sk/g, 'q'], [/f/g, 'p'], [/p/g, 'b'], [/b/g, 'v'], [/s/g, 'c'],
                [/c/g, 'd'], [/d/g, 'z'], [/t/g, 'r'], [/r/g, "'"], [/l/g, 'l'],
                [/ç/g, 'g'], [/ģ/g, 'gh'], [/x/g, 'k'], [/k/g, 'g'], [/g/g, 'gh'],
                [/'/g, 'q']
            ];

            const vowelReplacements = {
                'a': ['i', 'u'], 'i': 'e', 'ï': 'ui', 'u': 'o', 'ü': 'ü', 'e': 'a',
                'ë': 'oi', 'o': 'u', 'ö': 'ö', 'ā': 'a', 'ī': 'i', 'î': 'u',
                'ū': 'u', 'û': 'ü', 'ē': 'e', 'ê': 'o', 'ō': 'o', 'ô': 'ö',
                'ā': 'a'
            };

            // Apply consonant replacements
            for (const [pattern, replacement] of consonantReplacements) {
                text = text.replace(pattern, replacement);
            }

            // Apply vowel replacements
            for (const [key, value] of Object.entries(vowelReplacements)) {
                if (typeof value === 'string') {
                    text = text.replace(new RegExp(key, 'g'), value);
                }
            }

            // Additional cleaning and return final text
            return text.replace(/#/g, '').replace(/ģ/g, 'g');
        }

        // Function to read and transform text from the uploaded file
        function uploadAndTransform() {
            const fileInput = document.getElementById("file-input");
            const file = fileInput.files[0];

            if (!file) {
                alert("Please upload a text file!");
                return;
            }

            const reader = new FileReader();
            reader.onload = function(event) {
                const fileContent = event.target.result;

                // Transform the content of the uploaded file
                let transformedText = replaceLongVowels(fileContent);
                transformedText = replaceText(transformedText);

                // Display the transformed text
                document.getElementById("output-text").textContent = transformedText;
            };
            
            // Read the file as text
            reader.readAsText(file);
        }
    </script>
</body>
</html>
